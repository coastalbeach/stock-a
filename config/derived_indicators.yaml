# 衍生指标配置文件
# 定义各种实体类型（股票、行业、指数）的衍生指标

# 通用指标配置
# 这些指标适用于所有类型的实体
common_indicators:
  # 金叉信号
  golden_cross:
    name: "金叉信号"
    description: "短期均线从下方穿过长期均线形成的买入信号"
    required_columns: ["SMA5", "SMA20"]
    type: "SMALLINT"
    default: 0
  
  # 死叉信号
  death_cross:
    name: "死叉信号"
    description: "短期均线从上方穿过长期均线形成的卖出信号"
    required_columns: ["SMA5", "SMA20"]
    type: "SMALLINT"
    default: 0
  
  # RSI超买信号
  rsi_overbought:
    name: "RSI超买"
    description: "RSI指标超过70，表示可能超买"
    required_columns: ["RSI14"]
    type: "SMALLINT"
    default: 0
  
  # RSI超卖信号
  rsi_oversold:
    name: "RSI超卖"
    description: "RSI指标低于30，表示可能超卖"
    required_columns: ["RSI14"]
    type: "SMALLINT"
    default: 0
  
  # MACD金叉信号
  macd_golden_cross:
    name: "MACD金叉"
    description: "DIFF从下方穿过DEA形成的买入信号"
    required_columns: ["DIFF", "DEA"]
    type: "SMALLINT"
    default: 0
  
  # MACD死叉信号
  macd_death_cross:
    name: "MACD死叉"
    description: "DIFF从上方穿过DEA形成的卖出信号"
    required_columns: ["DIFF", "DEA"]
    type: "SMALLINT"
    default: 0

# 股票特有指标
stock_indicators:
  # 量价背离
  volume_price_divergence:
    name: "量价背离"
    description: "价格创新高但成交量未创新高，或价格创新低但成交量未创新低"
    required_columns: ["收盘价", "成交量"]
    type: "SMALLINT"
    default: 0
  
  # 突破前期高点
  break_previous_high:
    name: "突破前期高点"
    description: "价格突破前期高点"
    required_columns: ["最高价"]
    type: "SMALLINT"
    default: 0
  
  # 跌破前期低点
  break_previous_low:
    name: "跌破前期低点"
    description: "价格跌破前期低点"
    required_columns: ["最低价"]
    type: "SMALLINT"
    default: 0

# 行业特有指标
industry_indicators:
  # 行业强度
  industry_strength:
    name: "行业强度"
    description: "行业当前价格相对于20日均线的强度"
    required_columns: ["收盘", "SMA20"]
    type: "FLOAT"
    default: 0.0
  
  # 行业轮动信号
  industry_rotation:
    name: "行业轮动信号"
    description: "行业相对大盘的强弱变化信号"
    required_columns: ["收盘"]
    type: "SMALLINT"
    default: 0
  
  # 行业趋势强度
  industry_trend_strength:
    name: "行业趋势强度"
    description: "行业价格趋势的强度"
    required_columns: ["收盘", "SMA20", "SMA60"]
    type: "FLOAT"
    default: 0.0

# 指数特有指标
index_indicators:
  # 市场宽度
  market_breadth:
    name: "市场宽度"
    description: "上涨股票数量与下跌股票数量之比"
    required_columns: ["收盘"]
    type: "FLOAT"
    default: 0.0
  
  # 市场情绪
  market_sentiment:
    name: "市场情绪"
    description: "基于多个技术指标综合计算的市场情绪指标"
    required_columns: ["RSI14", "MACD", "KDJ_K"]
    type: "FLOAT"
    default: 0.0
  
  # 波动率
  volatility:
    name: "波动率"
    description: "价格波动的剧烈程度"
    required_columns: ["最高价", "最低价"]
    type: "FLOAT"
    default: 0.0

# 表结构定义
tables:
  # 股票衍生指标表
  股票衍生指标:
    name: 股票衍生指标
    description: "A股股票衍生技术指标数据表"
    partitioning:
      type: HASH
      column: 股票代码
      partitions: 16  # 创建16个分区
    columns:
      股票代码:
        type: VARCHAR(10)
        primary_key: true
        description: "股票代码，不含市场标识"
      日期:
        type: DATE
        primary_key: true
        description: "交易日期"
      # 基础轮动指标
      金叉信号:
        type: INTEGER
        description: "金叉信号，1表示金叉，0表示无信号"
      量价背离信号:
        type: INTEGER
        description: "量价背离信号，1表示背离，0表示无背离"
      # 相对中证全指MACD轮动指标
      相对中证全指DIF差值:
        type: FLOAT
        description: "股票DIF与中证全指DIF的差值"
      相对中证全指DEA差值:
        type: FLOAT
        description: "股票DEA与中证全指DEA的差值"
      相对中证全指MACD差值:
        type: FLOAT
        description: "股票MACD柱状图与中证全指MACD柱状图的差值"
      相对中证全指轮动信号:
        type: INTEGER
        description: "相对中证全指的轮动信号，2=强势上涨，1=温和上涨，0=中性，-1=温和下跌，-2=强势下跌"
      # 相对行业MACD轮动指标
      相对行业DIF差值:
        type: FLOAT
        description: "股票DIF与所属行业DIF的差值"
      相对行业DEA差值:
        type: FLOAT
        description: "股票DEA与所属行业DEA的差值"
      相对行业MACD差值:
        type: FLOAT
        description: "股票MACD柱状图与所属行业MACD柱状图的差值"
      相对行业轮动强度:
        type: FLOAT
        description: "相对行业的轮动强度，标准化后的DIF差值"
      相对行业轮动信号:
        type: INTEGER
        description: "相对行业的轮动信号，2=强于行业，1=略强于行业，0=与行业同步，-1=略弱于行业，-2=弱于行业"
      # 相对市场MACD轮动指标
      相对市场DIF差值:
        type: FLOAT
        description: "股票DIF与所属市场指数DIF的差值"
      相对市场DEA差值:
        type: FLOAT
        description: "股票DEA与所属市场指数DEA的差值"
      相对市场MACD差值:
        type: FLOAT
        description: "股票MACD柱状图与所属市场指数MACD柱状图的差值"
      相对市场动量信号:
        type: INTEGER
        description: "相对市场的动量信号，1=上升动量，0=中性，-1=下降动量"
      相对市场强度排名:
        type: FLOAT
        description: "DIF差值在20日内的百分位排名，0-1之间"
      相对市场轮动信号:
        type: INTEGER
        description: "相对市场的轮动信号，2=强于市场，1=略强于市场，0=与市场同步，-1=略弱于市场，-2=弱于市场"
      # 相对市值等级MACD轮动指标
      相对市值等级DIF差值:
        type: FLOAT
        description: "股票DIF与同市值等级DIF均值的差值"
      相对市值等级DEA差值:
        type: FLOAT
        description: "股票DEA与同市值等级DEA均值的差值"
      相对市值等级MACD差值:
        type: FLOAT
        description: "股票MACD柱状图与同市值等级MACD柱状图均值的差值"
      相对市值等级DIF标准分:
        type: FLOAT
        description: "DIF差值的标准化分数"
      相对市值等级DEA标准分:
        type: FLOAT
        description: "DEA差值的标准化分数"
      相对市值等级MACD标准分:
        type: FLOAT
        description: "MACD柱状图差值的标准化分数"
      相对市值等级综合评分:
        type: FLOAT
        description: "相对市值等级的综合评分"
      相对市值等级轮动信号:
        type: INTEGER
        description: "相对市值等级的轮动信号，2=强于同级，1=略强于同级，0=与同级同步，-1=略弱于同级，-2=弱于同级"
      # 综合MACD轮动指标
      轮动信号加总:
        type: INTEGER
        description: "四个维度轮动信号的简单加总"
      加权轮动评分:
        type: FLOAT
        description: "加权轮动信号评分"
      正向信号数量:
        type: INTEGER
        description: "正向信号的数量（0-4）"
      负向信号数量:
        type: INTEGER
        description: "负向信号的数量（0-4）"
      强正向信号数量:
        type: INTEGER
        description: "强正向信号的数量（0-4）"
      强负向信号数量:
        type: INTEGER
        description: "强负向信号的数量（0-4）"
      综合DIF差值:
        type: FLOAT
        description: "加权DIF差值综合指标"
      趋势一致性:
        type: INTEGER
        description: "趋势一致性：1=上升趋势一致，-1=下降趋势一致，0=趋势不一致"
      轮动强度:
        type: INTEGER
        description: "轮动强度：3=极强，2=强，1=弱正，0=中性，-1=弱负，-2=强负，-3=极弱"
      综合轮动信号:
        type: INTEGER
        description: "综合轮动信号：2=强烈买入，1=买入，0=中性，-1=卖出，-2=强烈卖出"
      信号置信度:
        type: FLOAT
        description: "信号置信度：有效信号数量占比（0-1）"
      updated_at:
        type: TIMESTAMP
        default: CURRENT_TIMESTAMP
        description: "数据更新时间"
    indexes:
      - name: idx_股票衍生指标_日期
        columns: ["日期"]
  
  # 行业衍生指标表
  行业衍生指标:
    name: 行业衍生指标
    description: "行业衍生技术指标数据表"
    columns:
      行业名称:
        type: VARCHAR(50)
        primary_key: true
        description: "行业名称"
      日期:
        type: DATE
        primary_key: true
        description: "交易日期"
      updated_at:
        type: TIMESTAMP
        default: CURRENT_TIMESTAMP
        description: "数据更新时间"
    indexes:
      - name: idx_行业衍生指标_日期
        columns: ["日期"]
  
  # 指数衍生指标表
  指数衍生指标:
    name: 指数衍生指标
    description: "指数衍生技术指标数据表"
    columns:
      指数代码:
        type: VARCHAR(10)
        primary_key: true
        description: "指数代码"
      日期:
        type: DATE
        primary_key: true
        description: "交易日期"
      updated_at:
        type: TIMESTAMP
        default: CURRENT_TIMESTAMP
        description: "数据更新时间"
    indexes:
      - name: idx_指数衍生指标_日期
        columns: ["日期"]